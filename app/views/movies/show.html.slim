h1 Movies#show

div id="#{@movie_id}"
/search.html.slimと同じ
- @reviews.each do |review|
  = link_to review_path(review)
    p= "名前 #{review.user.name}"
    p= "総合スコア #{review.total_score}"
    p= review.body
  p------------------

javascript:
  movie_id = gon.movie_id //moviesコントローラーで定義した変数を代入
  total_score_avg = gon.total_score_avg //moviesコントローラーで定義した変数を代入
  fetch(`https://api.themoviedb.org/3/movie/${movie_id}?api_key=${gon.TMDb_KEY}&language=ja-JP`)
  .then(response => {
    return response.json();
  })
  .then(data => {
    console.log(data);

    // ルーティングで定義したmoviesコントローラにapiのdataを:contentとして送る
    // $.ajax({
    //   url: "/movies/movie_data",
    //   type: "GET",
    //   data: {content : data},
    //   datatype: "html",
    // });

    container = document.getElementById(movie_id);
    const row = document.createElement('div');
    row.classList.add('item', 'row');

    const poster_section = document.createElement('div');
    poster_section.classList.add('poster_section', 'col-md-4', 'col-sm-12');

    const poster = document.createElement('img');
    poster.classList.add('poster');
    poster.src = `https://image.tmdb.org/t/p/w300_and_h450_bestv2/${data.poster_path}`;

    const score = document.createElement('p');
    score.classList.add('score');

    if(total_score_avg === null) {
    score.textContent = `レビュー無し`;
    } else {
    score.textContent = `平均スコア ${total_score_avg.toFixed(1)}`; //小数点以下1桁(*近似値)
    }

    const post = document.createElement('a');
    post.setAttribute('class', 'post');
    post.setAttribute('href', `/reviews/new?movie_id=${movie_id}`);
    post.textContent = 'レビューする';

    const info_section = document.createElement('div');
    info_section.classList.add('info_section', 'col-md-8', 'col-sm-12');

    const title = document.createElement('h4');
    title.setAttribute('class', 'title');
    title.textContent = data.title;

    const genres = document.createElement('p');
    genres.setAttribute('class', 'genres');
    genres.textContent = data.genres.map(genre => { return genre.name });

    const release_date = document.createElement('p');
    release_date.setAttribute('class', 'release_date');
    release_date.textContent = data.release_date;

    const overview = document.createElement('p');
    overview.setAttribute('class', 'overview');
    overview.textContent = data.overview;

    container.appendChild(row);
      row.appendChild(poster_section);
        poster_section.appendChild(poster);
        poster_section.appendChild(score);
        poster_section.appendChild(post);
      row.appendChild(info_section);
        info_section.appendChild(title);
        info_section.appendChild(genres);
        info_section.appendChild(release_date);
        info_section.appendChild(overview);
  })
